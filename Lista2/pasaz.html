<!doctype html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0">
<title>Wireshark: IP Location Map</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css"
    integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
    crossorigin="">
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css"
    integrity="sha512-BBToHPBStgMiw0lD4AtkRIZmdndhB6aQbXpX7omcrXeG2PauGBl2lzq2xUZTxaLxYz5IDHlmneCZ1IJ+P3kYtQ=="
    crossorigin="">
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css"
    integrity="sha512-RLEjtaFGdC4iQMJDbMzim/dOvAu+8Qp9sw7QE4wIMYcg2goVoivzwgSZq9CsIxp4xKAZPKh5J2f2lOko2Ze6FQ=="
    crossorigin="">
<!--
<link rel="stylesheet" href="https://unpkg.com/leaflet-measure@3.1.0/dist/leaflet-measure.css"
    integrity="sha512-wgiKVjb46JxgnGNL6xagIy2+vpqLQmmHH7fWD/BnPzouddSmbRTf6xatWIRbH2Rgr2F+tLtCZKbxnhm5Xz0BcA=="
    crossorigin="">
-->
<style>
html, body {
    margin: 0;
    padding: 0;
    height: 100%;
}
#map {
    height: 100%;
}
.file-picker-enabled #map, #file-picker-container {
    display: none;
}
.file-picker-enabled #file-picker-container {
    display: block;
    margin: 2em;
}
.range-control {
    padding: 3px 5px;
    color: #333;
    background: #fff;
    opacity: .5;
}
.range-control:hover { opacity: 1; }
.range-control-label { padding-right: 3px; }
.range-control-input { padding: 0; width: 130px; }
.range-control-input, .range-control-label { vertical-align: middle; }
</style>
<script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"
    integrity="sha512-QVftwZFqvtRNi0ZyCtsznlKSWOStnDORoefr1enyq5mVL4tmKB3S/EnC3rRJcxCPavG10IcrVGSmPh6Qw5lwrg=="
    crossorigin=""></script>
<script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js"
    integrity="sha512-MQlyPV+ol2lp4KodaU/Xmrn+txc1TP15pOBF/2Sfre7MRsA/pB4Vy58bEqe9u7a7DczMLtU5wT8n7OblJepKbg=="
    crossorigin=""></script>
<!--
<script src="https://unpkg.com/leaflet-measure@3.1.0/dist/leaflet-measure.js"
    integrity="sha512-ovh6EqS7MUI3QjLWBM7CY8Gu8cSM5x6vQofUMwKGbHVDPSAS2lmNv6Wq5es5WCz1muyojQxcc8rA3CvVjD2Z+A=="
    crossorigin=""></script>
-->
<script>
var map;

function sortIpKey(v) {
    if (/\./.test(v)) {
        // Assume IPv4. Convert 192.0.2.34 -> 192.000.002.034 for alpha sort.
        return v.replace(/\b\d\b/g, '00$&').replace(/\b\d{2}\b/g, '0$&');
    } else {
        // Assume IPv6. We won't handle :: correctly. Hope for the best.
        return v;
    }
}

function escapeHtml(text) {
    if (!text) return '';
    return text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
}
function sanitizeHtml(text) {
    // Handle legacy data containing <div class="geoip_property">...</div>
    // (since Wireshark 2.0) or <br/> (before v1.99.0-rc1-1781-g7e63805708).
    text = text
        .replace(/<div[^>]*>/g, '')
        .replace(/<\/div>|<br\/>/g, '\n')
        .replace(/&#39;/g, "'");
    return escapeHtml(text).replace(/\n/g, '<br>');
}

var RangeControl = L.Control.extend({
    options: {
        // @option label: String = 'Speed:'
        // The HTML text to be displayed next to the slider.
        label: '',
        title: '',

        min: 0,
        max: 100,
        value: 0,

        // @option onChange: Function = *
        // A `Function` that is called on slider value changes.
        // Called with two arguments, the new and previous range value.
    },
    onAdd: function(map) {
        var className = 'range-control';
        var container = L.DomUtil.create('div', className + ' leaflet-bar');
        L.DomEvent.disableClickPropagation(container);
        var label = L.DomUtil.create('label', className + '-label', container);
        var labelText = L.DomUtil.create('span', className + '-label', label);
        labelText.title = this.options.title;
        labelText.innerHTML = this.options.label;
        var input = L.DomUtil.create('input', className + '-input', label);
        this._input = input;
        input.type = 'range';
        input.min = this.options.min;
        input.max = this.options.max;
        this._lastValue = input.valueAsNumber = this.options.value;
        L.DomEvent.on(input, 'change', this._onInputChange, this);
        return container;
    },
    _onInputChange: function(ev) {
        var value = this._input.valueAsNumber;
        if (value !== this._lastValue) {
            if (this.options.onChange) {
                this.options.onChange(value, this._lastValue);
            }
            this._lastValue = value;
        }
    }
});

var rangeControl = function(options) {
    return new RangeControl(options);
};

function loadGeoJSON(obj) {
    'use strict';
    if (map) map.remove();
    map = L.map('map');
    var tileServer = 'https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png';
    L.tileLayer(tileServer, {
        minZoom: 2,
        maxZoom: 16,
        subdomains: 'abcd',
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>'
    }).addTo(map);
    L.control.scale().addTo(map);

    // Measurement tool, useful for investigating accuracy-related issues.
    if (L.control.measure) {
        L.control.measure({
            primaryLengthUnit: 'kilometers',
            secondaryLengthUnit: 'miles'
        }).addTo(map);
    }

    var geoJson = L.geoJSON(obj, {
        pointToLayer: function(feature, latlng) {
            // MaxMind databases use km for accuracy, but they always use
            // 50, 100, 200 or 1000. That is too course, so ignore it and use a
            // fixed 1km radius.
            // See https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=14693#c12
            return L.circle(latlng, {radius: 1e3});
        },
        onEachFeature: function(feature, layer) {
            var props = feature.properties;
            var title, lines = [];
            if (props.title && props.description) {
                title = escapeHtml(props.title);
                lines.push(sanitizeHtml(props.description));
            } else {
                title = escapeHtml(props.ip);
                if (props.autonomous_system_number) {
                    var line = 'AS: ' + props.autonomous_system_number;
                    line += ' (' + props.autonomous_system_organization + ')';
                    lines.push(escapeHtml(line));
                }
                if (props.city) {
                    lines.push(escapeHtml('City: ' + props.city));
                }
                if (props.country) {
                    lines.push(escapeHtml('Country: ' + props.country));
                }
                if ('packets' in props) {
                    lines.push(escapeHtml('Packets: ' + props.packets));
                }
                if ('bytes' in props) {
                    lines.push(escapeHtml('Bytes: ' + props.bytes));
                }
            }
            if (title) {
                layer.bindTooltip(title, {
                    offset: [10, 0],
                    direction: 'right',
                    sticky: true
                });
            }
            if (title && lines.length) {
                layer.bindPopup('<b>' + title + '</b><br>' + lines.join('<br>'));
            }
        }
    });

    map.on('zoomend', function() {
        // Ensure that the circles are clearly visible even when zoomed out.
        // Larger values will increase the size of the circle.
        var visibleZoomLevel = 9;
        var radius = 1e3;
        if (map.getZoom() < visibleZoomLevel) {
            // Enlarge radius to ensure it is easy to select.
            radius *= map.getZoomScale(visibleZoomLevel, map.getZoom());
        }
        geoJson.eachLayer(function(layer) {
            layer.setRadius(radius);
        });
    });

    // Cluster nearby/overlapping nodes by default.
    var clusterGroup = L.markerClusterGroup({
        zoomToBoundsOnClick: false,
        spiderfyOnMaxZoom: false,
        maxClusterRadius: 10
    });
    clusterGroup.addTo(map).addLayer(geoJson);
    map.fitWorld().fitBounds(clusterGroup.getBounds());

    // Summarize nodes within the cluster.
    clusterGroup.on('clustermouseover', function(ev) {
        // More addresses will be stripped.
        var cutoff = 30;
        var cluster = ev.propagatedFrom;
        var addresses = cluster.getAllChildMarkers().map(function(marker) {
            return marker.getTooltip().getContent();
        });
        addresses.sort(function(a, b) {
            a = sortIpKey(a);
            b = sortIpKey(b);
            return a === b ? 0 : (a < b ? -1 : 1);
        });
        var deleted = addresses.splice(cutoff).length;
        var title = addresses.join('<br>');
        if (deleted) {
            title += '<br>(and ' + deleted + ' more)';
        }
        cluster.bindTooltip(title, {
            offset: [10, 0],
            direction: 'right',
            sticky: true,
            opacity: 0.8
        }).openTooltip();
    }).on('clustermouseout', function(ev) {
        ev.propagatedFrom.unbindTooltip();
    }).on('clusterclick', function(ev) {
        ev.propagatedFrom.spiderfy();
    });

    // Provide an option to disable clustering
    rangeControl({
        label: 'Cluster radius:',
        title: 'Control merging of nearby nodes. Set to the minimum to disable merges.',
        min: 0,
        max: 100,
        value: clusterGroup.options.maxClusterRadius,
        onChange: function(value, oldValue) {
            // Apply new radius: remove map, clear markers and finally add new.
            clusterGroup.options.maxClusterRadius = value;
            clusterGroup.remove().clearLayers().addTo(map);
            // Value 0: clustering is disabled, the map is directly used.
            geoJson.remove().addTo(value === 0 ? map : clusterGroup);
        }
    }).addTo(map);
}

function showError(msg) {
    document.getElementById('error-message').textContent = msg;
    document.body.classList.add('file-picker-enabled');
}

function loadData(data) {
    'use strict';
    var html_match, what, error;
    var reOldHtml = /^ *var endpoints = (\{[\s\S]+? *\});$/m;
    // Complicated regex to support html-minifier.
    var reNewHtml = /<script[^>]+id="?ipmap-data"?(?: [^>]*)?>\s*(\{[\S\s]+?\})\s*<\/script>/;
    if ((html_match = reNewHtml.exec(data))) {
        // Match new ipmap.html file.
        what = 'new ipmap.html';
        data = html_match[1];
    } else if ((html_match = reOldHtml.exec(data))) {
        // Match old ipmap.html file
        what = 'old ipmap.html';
        var text = html_match[1].replace(/'/g, '"');
        text = text.replace(/ class="geoip_property"/g, '');
        data = text.replace(/\/\/ Start endpoint list.*/, '');
    } else if (/^\s*\{[\s\S]+\}\s*$/.test(data)) {
        // Assume GeoJSON (.json) file.
        what = 'GeoJSON file';
    } else {
        what = 'unknown file';
        error = 'Unrecognized file contents';
    }
    if (!error) {
        try {
            loadGeoJSON(JSON.parse(data));
            return true;
        } catch (e) {
            error = e;
        }
    }
    var msg = 'Failed to load map data from ' + what + ': ' + error;
    msg += '; data was: ' + data.substring(0, 120);
    if (data.length > 100) msg += '... (' + data.length + ' bytes)';
    showError(msg);
}

(function() {
    'use strict';
    function loadFromUrl(url) {
        var xhr = new XMLHttpRequest();
        xhr.open('GET', url, true);
        xhr.onload = function() {
            if (xhr.status !== 200) {
                showError('Failed to retrieve ' + url + ': ' + xhr.status + ' ' + xhr.statusText);
                return;
            }
            loadData(xhr.responseText);
        };
        xhr.onerror = function() {
            showError('Failed to retrieve ' + url + ': ' + xhr.status + ' ' + xhr.statusText);
        };
        xhr.send(null);
    }

    addEventListener('load', function() {
        // Note: FileReader and classList do not work with IE9 or older.
        var fileSelector = document.getElementById('file-picker');
        fileSelector.addEventListener('change', function() {
            if (!fileSelector.files.length) {
                return;
            }
            document.body.classList.remove('file-picker-enabled');
            var reader = new FileReader();
            reader.onload = function() {
                if (!loadData(reader.result)) {
                    document.body.classList.add('file-picker-enabled');
                }
            };
            reader.onerror = function() {
                showError('Failed to read file.');
            };
            reader.readAsText(fileSelector.files[0]);
        });

        // Force file picker when the "file" URL is given.
        var url = location.search.match(/[?&]url=([^&]*)/);
        if (url) {
            url = decodeURIComponent(url[1]);
            if (url) {
                loadFromUrl(url);
            } else {
                showError('');
            }
            return;
        }

        var data = document.getElementById('ipmap-data');
        if (data) {
            loadData(data.textContent);
        } else {
            showError('');
        }
    });
}());
</script>
<div id="file-picker-container">
<label>Select an ipmap.html or GeoJSON .json file as created by Wireshark.<br>
<input type="file" id="file-picker" accept=".json,.html"></label>
<p id="error-message"></p>
</div>
<div id="map"></div>
<!--
    Wireshark will append a script tag (id="ipmap-data" type="application/json")
    below, containing a GeoJSON object. If missing, then a file picker will be
    displayed which can be useful during development.
-->
<script id="ipmap-data" type="application/json">
{
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -97.822000000000003,
          37.750999999999998
        ]
      },
      "properties": {
        "ip": "13.107.3.128",
        "autonomous_system_number": 8068,
        "autonomous_system_organization": "Microsoft Corporation",
        "country": "United States",
        "radius": 1000,
        "packets": 187,
        "bytes": 134757
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -97.822000000000003,
          37.750999999999998
        ]
      },
      "properties": {
        "ip": "13.107.5.88",
        "autonomous_system_number": 8068,
        "autonomous_system_organization": "Microsoft Corporation",
        "country": "United States",
        "radius": 1000,
        "packets": 57,
        "bytes": 22280
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -97.822000000000003,
          37.750999999999998
        ]
      },
      "properties": {
        "ip": "13.107.21.200",
        "autonomous_system_number": 8068,
        "autonomous_system_organization": "Microsoft Corporation",
        "country": "United States",
        "radius": 1000,
        "packets": 53,
        "bytes": 13978
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          4.8994999999999997,
          52.382399999999997
        ]
      },
      "properties": {
        "ip": "23.6.112.171",
        "autonomous_system_number": 20940,
        "autonomous_system_organization": "Akamai International B.V.",
        "country": "Netherlands",
        "radius": 1000,
        "packets": 16,
        "bytes": 10497
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          4.8994999999999997,
          52.382399999999997
        ]
      },
      "properties": {
        "ip": "23.7.207.201",
        "autonomous_system_number": 16625,
        "autonomous_system_organization": "Akamai Technologies, Inc.",
        "country": "Netherlands",
        "radius": 1000,
        "packets": 71,
        "bytes": 30299
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -97.822000000000003,
          37.750999999999998
        ]
      },
      "properties": {
        "ip": "38.113.165.28",
        "autonomous_system_number": 174,
        "autonomous_system_organization": "Cogent Communications",
        "country": "United States",
        "radius": 1000,
        "packets": 18,
        "bytes": 1242
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -6.2488000000000001,
          53.333799999999997
        ]
      },
      "properties": {
        "ip": "40.67.251.132",
        "autonomous_system_number": 8075,
        "autonomous_system_organization": "Microsoft Corporation",
        "city": "Dublin",
        "country": "Ireland",
        "radius": 1000,
        "packets": 18,
        "bytes": 2302
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -6.2488000000000001,
          53.333799999999997
        ]
      },
      "properties": {
        "ip": "40.77.226.250",
        "autonomous_system_number": 8075,
        "autonomous_system_organization": "Microsoft Corporation",
        "city": "Dublin",
        "country": "Ireland",
        "radius": 1000,
        "packets": 55,
        "bytes": 21429
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          114.15000000000001,
          22.290900000000001
        ]
      },
      "properties": {
        "ip": "52.114.6.46",
        "autonomous_system_number": 8075,
        "autonomous_system_organization": "Microsoft Corporation",
        "city": "Central",
        "country": "Hong Kong",
        "radius": 1000,
        "packets": 31,
        "bytes": 15384
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -78.153899999999993,
          38.709499999999998
        ]
      },
      "properties": {
        "ip": "52.114.132.73",
        "autonomous_system_number": 8075,
        "autonomous_system_organization": "Microsoft Corporation",
        "city": "Washington",
        "country": "United States",
        "radius": 1000,
        "packets": 31,
        "bytes": 15439
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -6.2488000000000001,
          53.333799999999997
        ]
      },
      "properties": {
        "ip": "52.142.84.61",
        "autonomous_system_number": 8075,
        "autonomous_system_organization": "Microsoft Corporation",
        "city": "Dublin",
        "country": "Ireland",
        "radius": 1000,
        "packets": 1,
        "bytes": 54
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -6.2488000000000001,
          53.333799999999997
        ]
      },
      "properties": {
        "ip": "52.156.204.185",
        "autonomous_system_number": 8075,
        "autonomous_system_organization": "Microsoft Corporation",
        "city": "Dublin",
        "country": "Ireland",
        "radius": 1000,
        "packets": 22,
        "bytes": 5946
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          4.9086999999999996,
          52.353400000000001
        ]
      },
      "properties": {
        "ip": "52.157.234.37",
        "autonomous_system_number": 8075,
        "autonomous_system_organization": "Microsoft Corporation",
        "city": "Amsterdam",
        "country": "Netherlands",
        "radius": 1000,
        "packets": 58,
        "bytes": 28203
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -0.12239999999999999,
          51.496400000000001
        ]
      },
      "properties": {
        "ip": "62.67.238.136",
        "autonomous_system_number": 3356,
        "autonomous_system_organization": "Level 3 Parent, LLC",
        "country": "United Kingdom",
        "radius": 200,
        "packets": 29,
        "bytes": 2684
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -0.12239999999999999,
          51.496400000000001
        ]
      },
      "properties": {
        "ip": "62.67.238.138",
        "autonomous_system_number": 3356,
        "autonomous_system_organization": "Level 3 Parent, LLC",
        "country": "United Kingdom",
        "radius": 200,
        "packets": 92,
        "bytes": 9201
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -0.12239999999999999,
          51.496400000000001
        ]
      },
      "properties": {
        "ip": "62.67.238.140",
        "autonomous_system_number": 3356,
        "autonomous_system_organization": "Level 3 Parent, LLC",
        "country": "United Kingdom",
        "radius": 200,
        "packets": 7,
        "bytes": 402
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -0.12239999999999999,
          51.496400000000001
        ]
      },
      "properties": {
        "ip": "62.67.238.144",
        "autonomous_system_number": 3356,
        "autonomous_system_organization": "Level 3 Parent, LLC",
        "country": "United Kingdom",
        "radius": 200,
        "packets": 94,
        "bytes": 9459
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -0.12239999999999999,
          51.496400000000001
        ]
      },
      "properties": {
        "ip": "62.67.238.148",
        "autonomous_system_number": 3356,
        "autonomous_system_organization": "Level 3 Parent, LLC",
        "country": "United Kingdom",
        "radius": 200,
        "packets": 6,
        "bytes": 344
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -104.8193,
          41.139899999999997
        ]
      },
      "properties": {
        "ip": "64.4.54.254",
        "autonomous_system_number": 8075,
        "autonomous_system_organization": "Microsoft Corporation",
        "city": "Cheyenne",
        "country": "United States",
        "radius": 1000,
        "packets": 59,
        "bytes": 20264
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          37.6068,
          55.738599999999998
        ]
      },
      "properties": {
        "ip": "77.74.177.174",
        "autonomous_system_number": 200107,
        "autonomous_system_organization": "Kaspersky Lab AO",
        "country": "Russia",
        "radius": 1000,
        "packets": 13,
        "bytes": 954
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          37.6068,
          55.738599999999998
        ]
      },
      "properties": {
        "ip": "77.74.177.180",
        "autonomous_system_number": 200107,
        "autonomous_system_organization": "Kaspersky Lab AO",
        "country": "Russia",
        "radius": 1000,
        "packets": 10,
        "bytes": 1093
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          37.6068,
          55.738599999999998
        ]
      },
      "properties": {
        "ip": "77.74.181.28",
        "autonomous_system_number": 200107,
        "autonomous_system_organization": "Kaspersky Lab AO",
        "country": "Russia",
        "radius": 1000,
        "packets": 10,
        "bytes": 576
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -3.6840000000000002,
          40.417200000000001
        ]
      },
      "properties": {
        "ip": "81.19.104.18",
        "autonomous_system_number": 2914,
        "autonomous_system_organization": "NTT America, Inc.",
        "country": "Spain",
        "radius": 500,
        "packets": 6,
        "bytes": 340
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -3.6840000000000002,
          40.417200000000001
        ]
      },
      "properties": {
        "ip": "81.19.104.30",
        "autonomous_system_number": 2914,
        "autonomous_system_organization": "NTT America, Inc.",
        "country": "Spain",
        "radius": 500,
        "packets": 59,
        "bytes": 6299
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -3.6840000000000002,
          40.417200000000001
        ]
      },
      "properties": {
        "ip": "81.19.104.33",
        "autonomous_system_number": 2914,
        "autonomous_system_organization": "NTT America, Inc.",
        "country": "Spain",
        "radius": 500,
        "packets": 29,
        "bytes": 4240
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -3.6840000000000002,
          40.417200000000001
        ]
      },
      "properties": {
        "ip": "81.19.104.36",
        "autonomous_system_number": 2914,
        "autonomous_system_organization": "NTT America, Inc.",
        "country": "Spain",
        "radius": 500,
        "packets": 18,
        "bytes": 1028
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -3.6840000000000002,
          40.417200000000001
        ]
      },
      "properties": {
        "ip": "81.19.104.37",
        "autonomous_system_number": 2914,
        "autonomous_system_organization": "NTT America, Inc.",
        "country": "Spain",
        "radius": 500,
        "packets": 7,
        "bytes": 402
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -3.6840000000000002,
          40.417200000000001
        ]
      },
      "properties": {
        "ip": "81.19.104.39",
        "autonomous_system_number": 2914,
        "autonomous_system_organization": "NTT America, Inc.",
        "country": "Spain",
        "radius": 500,
        "packets": 9,
        "bytes": 620
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -3.6840000000000002,
          40.417200000000001
        ]
      },
      "properties": {
        "ip": "81.19.104.40",
        "autonomous_system_number": 2914,
        "autonomous_system_organization": "NTT America, Inc.",
        "country": "Spain",
        "radius": 500,
        "packets": 7,
        "bytes": 402
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -3.6840000000000002,
          40.417200000000001
        ]
      },
      "properties": {
        "ip": "81.19.104.42",
        "autonomous_system_number": 2914,
        "autonomous_system_organization": "NTT America, Inc.",
        "country": "Spain",
        "radius": 500,
        "packets": 6,
        "bytes": 344
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -3.6840000000000002,
          40.417200000000001
        ]
      },
      "properties": {
        "ip": "81.19.104.45",
        "autonomous_system_number": 2914,
        "autonomous_system_organization": "NTT America, Inc.",
        "country": "Spain",
        "radius": 500,
        "packets": 9,
        "bytes": 616
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -3.6840000000000002,
          40.417200000000001
        ]
      },
      "properties": {
        "ip": "81.19.104.52",
        "autonomous_system_number": 2914,
        "autonomous_system_organization": "NTT America, Inc.",
        "country": "Spain",
        "radius": 500,
        "packets": 389,
        "bytes": 58143
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -3.6840000000000002,
          40.417200000000001
        ]
      },
      "properties": {
        "ip": "81.19.104.54",
        "autonomous_system_number": 2914,
        "autonomous_system_organization": "NTT America, Inc.",
        "country": "Spain",
        "radius": 500,
        "packets": 10,
        "bytes": 678
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -3.6840000000000002,
          40.417200000000001
        ]
      },
      "properties": {
        "ip": "81.19.104.57",
        "autonomous_system_number": 2914,
        "autonomous_system_organization": "NTT America, Inc.",
        "country": "Spain",
        "radius": 500,
        "packets": 14,
        "bytes": 804
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -3.6840000000000002,
          40.417200000000001
        ]
      },
      "properties": {
        "ip": "81.19.104.63",
        "autonomous_system_number": 2914,
        "autonomous_system_organization": "NTT America, Inc.",
        "country": "Spain",
        "radius": 500,
        "packets": 7,
        "bytes": 402
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -3.6840000000000002,
          40.417200000000001
        ]
      },
      "properties": {
        "ip": "81.19.104.72",
        "autonomous_system_number": 2914,
        "autonomous_system_organization": "NTT America, Inc.",
        "country": "Spain",
        "radius": 500,
        "packets": 17,
        "bytes": 1080
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -3.6840000000000002,
          40.417200000000001
        ]
      },
      "properties": {
        "ip": "81.19.104.105",
        "autonomous_system_number": 2914,
        "autonomous_system_organization": "NTT America, Inc.",
        "country": "Spain",
        "radius": 500,
        "packets": 7,
        "bytes": 402
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -3.6840000000000002,
          40.417200000000001
        ]
      },
      "properties": {
        "ip": "81.19.104.114",
        "autonomous_system_number": 2914,
        "autonomous_system_organization": "NTT America, Inc.",
        "country": "Spain",
        "radius": 500,
        "packets": 75,
        "bytes": 12561
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          37.6068,
          55.738599999999998
        ]
      },
      "properties": {
        "ip": "82.202.185.135",
        "autonomous_system_number": 200107,
        "autonomous_system_organization": "Kaspersky Lab AO",
        "country": "Russia",
        "radius": 1000,
        "packets": 7,
        "bytes": 402
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          4.8994999999999997,
          52.382399999999997
        ]
      },
      "properties": {
        "ip": "91.198.174.192",
        "autonomous_system_number": 14907,
        "autonomous_system_organization": "Wikimedia Foundation Inc.",
        "country": "Netherlands",
        "radius": 100,
        "packets": 96,
        "bytes": 25423
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -97.822000000000003,
          37.750999999999998
        ]
      },
      "properties": {
        "ip": "104.74.143.169",
        "autonomous_system_number": 16625,
        "autonomous_system_organization": "Akamai Technologies, Inc.",
        "country": "United States",
        "radius": 1000,
        "packets": 18,
        "bytes": 6466
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -77.539000000000001,
          39.018000000000001
        ]
      },
      "properties": {
        "ip": "104.153.64.122",
        "autonomous_system_number": 29889,
        "autonomous_system_organization": "Fast Serv Networks, LLC",
        "city": "Ashburn",
        "country": "United States",
        "radius": 1000,
        "packets": 274,
        "bytes": 201984
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -98.493499999999997,
          29.424700000000001
        ]
      },
      "properties": {
        "ip": "104.214.77.221",
        "autonomous_system_number": 8075,
        "autonomous_system_organization": "Microsoft Corporation",
        "city": "San Antonio",
        "country": "United States",
        "radius": 1000,
        "packets": 23,
        "bytes": 8605
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -97.822000000000003,
          37.750999999999998
        ]
      },
      "properties": {
        "ip": "108.177.14.188",
        "autonomous_system_number": 15169,
        "autonomous_system_organization": "Google LLC",
        "country": "United States",
        "radius": 1000,
        "packets": 107,
        "bytes": 11520
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          8.6843000000000004,
          50.1188
        ]
      },
      "properties": {
        "ip": "151.101.14.110",
        "autonomous_system_number": 54113,
        "autonomous_system_organization": "Fastly",
        "city": "Frankfurt am Main",
        "country": "Germany",
        "radius": 1000,
        "packets": 63,
        "bytes": 12054
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -96.802099999999996,
          32.788899999999998
        ]
      },
      "properties": {
        "ip": "151.139.128.14",
        "autonomous_system_number": 20446,
        "autonomous_system_organization": "Highwinds Network Group, Inc.",
        "city": "Dallas",
        "country": "United States",
        "radius": 1000,
        "packets": 37,
        "bytes": 5636
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -97.822000000000003,
          37.750999999999998
        ]
      },
      "properties": {
        "ip": "152.199.19.161",
        "autonomous_system_number": 15133,
        "autonomous_system_organization": "MCI Communications Services, Inc. d/b/a Verizon Business",
        "country": "United States",
        "radius": 1000,
        "packets": 70,
        "bytes": 34706
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -122.49460000000001,
          37.860100000000003
        ]
      },
      "properties": {
        "ip": "162.247.242.21",
        "autonomous_system_number": 23467,
        "autonomous_system_organization": "New Relic",
        "city": "Sausalito",
        "country": "United States",
        "radius": 500,
        "packets": 40,
        "bytes": 6718
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -97.822000000000003,
          37.750999999999998
        ]
      },
      "properties": {
        "ip": "172.217.16.1",
        "autonomous_system_number": 15169,
        "autonomous_system_organization": "Google LLC",
        "country": "United States",
        "radius": 1000,
        "packets": 92,
        "bytes": 44457
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -97.822000000000003,
          37.750999999999998
        ]
      },
      "properties": {
        "ip": "172.217.16.3",
        "autonomous_system_number": 15169,
        "autonomous_system_organization": "Google LLC",
        "country": "United States",
        "radius": 1000,
        "packets": 179,
        "bytes": 32519
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -97.822000000000003,
          37.750999999999998
        ]
      },
      "properties": {
        "ip": "172.217.16.14",
        "autonomous_system_number": 15169,
        "autonomous_system_organization": "Google LLC",
        "country": "United States",
        "radius": 1000,
        "packets": 78,
        "bytes": 15859
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -97.822000000000003,
          37.750999999999998
        ]
      },
      "properties": {
        "ip": "172.217.16.19",
        "autonomous_system_number": 15169,
        "autonomous_system_organization": "Google LLC",
        "country": "United States",
        "radius": 1000,
        "packets": 49,
        "bytes": 8614
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -97.822000000000003,
          37.750999999999998
        ]
      },
      "properties": {
        "ip": "172.217.16.35",
        "autonomous_system_number": 15169,
        "autonomous_system_organization": "Google LLC",
        "country": "United States",
        "radius": 1000,
        "packets": 79,
        "bytes": 16201
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -97.822000000000003,
          37.750999999999998
        ]
      },
      "properties": {
        "ip": "172.217.16.42",
        "autonomous_system_number": 15169,
        "autonomous_system_organization": "Google LLC",
        "country": "United States",
        "radius": 1000,
        "packets": 51,
        "bytes": 11300
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -97.822000000000003,
          37.750999999999998
        ]
      },
      "properties": {
        "ip": "172.217.20.177",
        "autonomous_system_number": 15169,
        "autonomous_system_organization": "Google LLC",
        "country": "United States",
        "radius": 1000,
        "packets": 196,
        "bytes": 34188
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -97.822000000000003,
          37.750999999999998
        ]
      },
      "properties": {
        "ip": "172.217.20.195",
        "autonomous_system_number": 15169,
        "autonomous_system_organization": "Google LLC",
        "country": "United States",
        "radius": 1000,
        "packets": 67,
        "bytes": 21523
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -97.822000000000003,
          37.750999999999998
        ]
      },
      "properties": {
        "ip": "172.217.20.202",
        "autonomous_system_number": 15169,
        "autonomous_system_organization": "Google LLC",
        "country": "United States",
        "radius": 1000,
        "packets": 148,
        "bytes": 113954
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -0.12239999999999999,
          51.496400000000001
        ]
      },
      "properties": {
        "ip": "195.122.177.156",
        "autonomous_system_number": 3356,
        "autonomous_system_organization": "Level 3 Parent, LLC",
        "country": "United Kingdom",
        "radius": 200,
        "packets": 23,
        "bytes": 1554
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -0.12239999999999999,
          51.496400000000001
        ]
      },
      "properties": {
        "ip": "195.122.177.183",
        "autonomous_system_number": 3356,
        "autonomous_system_organization": "Level 3 Parent, LLC",
        "country": "United Kingdom",
        "radius": 200,
        "packets": 10,
        "bytes": 678
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -96.821700000000007,
          32.778700000000001
        ]
      },
      "properties": {
        "ip": "198.58.127.163",
        "autonomous_system_number": 63949,
        "autonomous_system_organization": "Linode, LLC",
        "city": "Dallas",
        "country": "United States",
        "radius": 1000,
        "packets": 21,
        "bytes": 9020
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -97.822000000000003,
          37.750999999999998
        ]
      },
      "properties": {
        "ip": "204.79.197.200",
        "autonomous_system_number": 8068,
        "autonomous_system_organization": "Microsoft Corporation",
        "country": "United States",
        "radius": 1000,
        "packets": 97,
        "bytes": 36793
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -97.822000000000003,
          37.750999999999998
        ]
      },
      "properties": {
        "ip": "209.85.233.188",
        "autonomous_system_number": 15169,
        "autonomous_system_organization": "Google LLC",
        "country": "United States",
        "radius": 1000,
        "packets": 1,
        "bytes": 54
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -122.0748,
          37.404299999999999
        ]
      },
      "properties": {
        "ip": "216.58.209.14",
        "autonomous_system_number": 15169,
        "autonomous_system_organization": "Google LLC",
        "city": "Mountain View",
        "country": "United States",
        "radius": 1000,
        "packets": 1608,
        "bytes": 1823522
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -122.0748,
          37.404299999999999
        ]
      },
      "properties": {
        "ip": "216.58.209.22",
        "autonomous_system_number": 15169,
        "autonomous_system_organization": "Google LLC",
        "city": "Mountain View",
        "country": "United States",
        "radius": 1000,
        "packets": 374,
        "bytes": 299389
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -122.0748,
          37.404299999999999
        ]
      },
      "properties": {
        "ip": "216.58.215.67",
        "autonomous_system_number": 15169,
        "autonomous_system_organization": "Google LLC",
        "city": "Mountain View",
        "country": "United States",
        "radius": 1000,
        "packets": 197,
        "bytes": 34616
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -122.0748,
          37.404299999999999
        ]
      },
      "properties": {
        "ip": "216.58.215.68",
        "autonomous_system_number": 15169,
        "autonomous_system_organization": "Google LLC",
        "city": "Mountain View",
        "country": "United States",
        "radius": 1000,
        "packets": 222,
        "bytes": 113451
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -122.0748,
          37.404299999999999
        ]
      },
      "properties": {
        "ip": "216.58.215.78",
        "autonomous_system_number": 15169,
        "autonomous_system_organization": "Google LLC",
        "city": "Mountain View",
        "country": "United States",
        "radius": 1000,
        "packets": 251,
        "bytes": 94862
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -122.0748,
          37.404299999999999
        ]
      },
      "properties": {
        "ip": "216.58.215.99",
        "autonomous_system_number": 15169,
        "autonomous_system_organization": "Google LLC",
        "city": "Mountain View",
        "country": "United States",
        "radius": 1000,
        "packets": 45,
        "bytes": 8760
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -122.0748,
          37.404299999999999
        ]
      },
      "properties": {
        "ip": "216.58.215.106",
        "autonomous_system_number": 15169,
        "autonomous_system_organization": "Google LLC",
        "city": "Mountain View",
        "country": "United States",
        "radius": 1000,
        "packets": 104,
        "bytes": 22667
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -122.0748,
          37.404299999999999
        ]
      },
      "properties": {
        "ip": "216.58.215.113",
        "autonomous_system_number": 15169,
        "autonomous_system_organization": "Google LLC",
        "city": "Mountain View",
        "country": "United States",
        "radius": 1000,
        "packets": 205,
        "bytes": 34903
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -122.2959,
          37.869599999999998
        ]
      },
      "properties": {
        "ip": "216.239.32.116",
        "autonomous_system_number": 15169,
        "autonomous_system_organization": "Google LLC",
        "city": "Berkeley",
        "country": "United States",
        "radius": 1000,
        "packets": 57,
        "bytes": 9761
      }
    }
  ]
}
</script>
